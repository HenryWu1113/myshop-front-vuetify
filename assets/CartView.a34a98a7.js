import{o as T,A as B,L as U,aq as j,r as F,M as v,B as C,a as p,c as V,F as P,O as A,d as e,w as a,V as y,a4 as z,a3 as D,b as c,a7 as G,S as I,Q as L,$ as O,P as f,f as r,N as d,G as m,a2 as b,e as R,aF as E,T as Q,aG as k,U as W}from"./index.13eabeb3.js";import"./index.3ac66538.js";import{v as H}from"./index.882724bf.js";import"./isEmail.4817bf3e.js";const J={class:"MyContainer"},K=c("h1",{class:"text-h2 text-center text-brown font-weight-bold mt-10","data-aos":"fade-down","data-aos-duration":"1000","data-aos-offset":"150"},"\u8CFC\u7269\u8ECA",-1),X=["onClick"],Y={class:"text-h6 text-deep-orange"},Z={class:"ms-3 me-3 text-h6"},ee={class:"text-h6 text-deep-orange"},te={key:1,class:"text-h1 text-center mt-10"},ae={class:"text-h6 text-red"},se=W(" \u78BA\u8A8D\u4E26\u9001\u51FA "),ue={__name:"CartView",setup(le){T(()=>{B.init()});const g=U(),w=j(),{updateCart:q,checkout:S}=w,_=F(!1),n=v([]),o=v({receiver:"",cellphone:"",address:""}),u=v({required(s){return!!s||"\u5FC5\u586B"},isMobilePhone(s){return H.exports.isMobilePhone(s,"zh-TW")||"\u624B\u6A5F\u865F\u78BC\u683C\u5F0F\u932F\u8AA4"}}),$=C(()=>n.reduce((s,l)=>s+l.product.price*l.quantity,0)),M=C(()=>n.length>0&&!n.some(s=>!s.product.sell)),h=async(s,l)=>{await q({product:n[s].product._id,quantity:l})&&(l===0?n.splice(s,1):n[s].quantity=l)},N=async()=>{!_.value||(S({receiver:o.receiver,cellphone:o.cellphone,address:o.address}),o.receiver="",o.cellphone="",o.address="")};return(async()=>{try{const{data:s}=await G.get("/users/cart");n.push(...s.result)}catch{I.fire({icon:"error",title:"\u5931\u6557",text:"\u4F3A\u670D\u5668\u932F\u8AA4"})}})(),(s,l)=>(p(),V("div",J,[K,n.length>0?(p(!0),V(P,{key:0},A(n,(t,x)=>(p(),L(y,{class:E(["mt-4",{"bg-error":!t.product.sell}]),key:t._id},{default:a(()=>[e(r,{cols:"12",md:""},{default:a(()=>[e(O,{src:t.product.image,onClick:i=>f(g).push(`/product/${t.product._id}`),style:{cursor:"pointer"}},null,8,["src","onClick"])]),_:2},1024),e(r,{cols:"12",md:"",class:"d-flex align-center justify-center text-center"},{default:a(()=>[c("h2",{class:"text-brown",onClick:i=>f(g).push(`/product/${t.product._id}`),style:{cursor:"pointer"}},d(t.product.name),9,X)]),_:2},1024),e(r,{cols:"12",md:"",class:"d-flex align-center justify-center text-center"},{default:a(()=>[c("span",Y,"NT. "+d(t.product.price),1)]),_:2},1024),e(r,{cols:"12",md:"",class:"d-flex align-center justify-center text-center"},{default:a(()=>[e(m,{icon:"",variant:"text",onClick:i=>h(x,t.quantity-1),disabled:t.quantity<2},{default:a(()=>[e(b,{icon:"mdi-minus",color:"brown"})]),_:2},1032,["onClick","disabled"]),c("span",Z,d(t.quantity),1),e(m,{icon:"",variant:"text",onClick:i=>h(x,t.quantity+1)},{default:a(()=>[e(b,{icon:"mdi-plus",color:"brown"})]),_:2},1032,["onClick"])]),_:2},1024),e(r,{cols:"12",md:"",class:"d-flex align-center justify-center text-center"},{default:a(()=>[c("span",ee,"NT. "+d(t.product.price*t.quantity),1)]),_:2},1024),e(r,{cols:"12",md:"",class:"d-flex align-center justify-center text-center"},{default:a(()=>[e(m,{icon:"",variant:"text",color:"red",onClick:i=>h(x,0)},{default:a(()=>[e(b,{icon:"mdi-trash-can-outline"})]),_:2},1032,["onClick"])]),_:2},1024),e(R,{class:"d-none d-md-block"})]),_:2},1032,["class"]))),128)):(p(),V("h1",te,"\u6C92\u6709\u5546\u54C1\u54E6")),e(y,null,{default:a(()=>[e(Q),e(r,{cols:"12",md:"3",class:"text-center mt-10"},{default:a(()=>[c("span",ae,"\u7E3D\u50F9 : NT."+d(f($)),1)]),_:1})]),_:1}),e(D,{modelValue:_.value,"onUpdate:modelValue":l[3]||(l[3]=t=>_.value=t),onSubmit:z(N,["prevent"])},{default:a(()=>[e(y,null,{default:a(()=>[e(r,{cols:"12",md:"6"},{default:a(()=>[e(k,{modelValue:o.receiver,"onUpdate:modelValue":l[0]||(l[0]=t=>o.receiver=t),type:"text",label:"\u6536\u4EF6\u8005\u59D3\u540D",placeholder:"\u8ACB\u8F38\u5165\u6536\u4EF6\u8005\u59D3\u540D",counter:"10",maxlength:"10",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(r,{cols:"12",md:"6"},{default:a(()=>[e(k,{modelValue:o.cellphone,"onUpdate:modelValue":l[1]||(l[1]=t=>o.cellphone=t),type:"text",label:"\u6536\u4EF6\u8005\u96FB\u8A71",placeholder:"\u8ACB\u8F38\u5165\u6536\u4EF6\u8005\u96FB\u8A71",rules:[u.required,u.isMobilePhone],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(r,{cols:"12"},{default:a(()=>[e(k,{modelValue:o.address,"onUpdate:modelValue":l[2]||(l[2]=t=>o.address=t),type:"text",label:"\u6536\u4EF6\u5730\u5740",placeholder:"\u8ACB\u8F38\u5165\u6536\u4EF6\u5730\u5740",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(r,{cols:"12",md:"2",class:"ma-auto"},{default:a(()=>[e(m,{color:"warning",block:"",variant:"outlined",type:"submit",disabled:!f(M)},{default:a(()=>[se]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]))}};export{ue as default};
