import{r as b,o as A,A as I,M as R,a3 as z,N as k,C as N,a as c,c as u,b as d,t as i,F as B,O as D,Q as _,w as a,V as f,d as e,a8 as H,a7 as L,R as M,ab as O,T as W,a1 as E,P as h,f as o,H as v,a6 as w,e as G,aG as Q,U as X,aH as C,W as J,X as K}from"./index.b79e5a8d.js";import{v as Y}from"./index.85d3e503.js";import"./assertString.31c1207f.js";import"./isEmail.07d4cae7.js";import"./isMobilePhone.1f4ee56f.js";var Z="./assets/pngwingtw.f95cd9bd.png",ee="./assets/pngwingen.7d11c938.png",te="./assets/pngwingjp.227d60f4.png";const ae={id:"cart_view"},se={class:"MyContainer"},le={class:"text-h2 text-center text-brown font-weight-bold mt-10","data-aos":"fade-down","data-aos-duration":"1000","data-aos-offset":"150"},ne=["onClick"],oe={class:"text-h6 text-deep-orange"},re={class:"ms-3 me-3 text-h6"},ce={class:"text-h6 text-deep-orange"},de={key:0,src:Z,class:"animate__animated animate__rubberBand"},ie={key:1,src:ee,class:"animate__animated animate__tada"},ue={key:2,src:te,class:"animate__animated animate__heartBeat"},pe={class:"text-h6 text-red"},xe={__name:"CartView",setup(me){const $=b(!1),g=b(!1);A(()=>{I.init()});const q=R(),S=z(),{updateCart:T,checkout:j}=S,y=b(!1),r=k([]),n=k({receiver:"",cellphone:"",address:""}),p=k({required(s){return!!s||"\u5FC5\u586B"},isMobilePhone(s){return Y.exports.isMobilePhone(s,"zh-TW")||"\u624B\u6A5F\u865F\u78BC\u683C\u5F0F\u932F\u8AA4"}}),U=N(()=>r.reduce((s,l)=>s+l.product.price*l.quantity,0)),P=N(()=>r.length>0&&!r.some(s=>!s.product.sell)),x=async(s,l)=>{await T({product:r[s].product._id,quantity:l})&&(l===0?r.splice(s,1):r[s].quantity=l)},F=async()=>{!y.value||j({receiver:n.receiver,cellphone:n.cellphone,address:n.address})};return(async()=>{try{n.receiver="",n.cellphone="",n.address="",g.value=!0;const{data:s}=await O.get("/users/cart");r.push(...s.result),g.value=!1,$.value=!0}catch{W.fire({icon:"error",title:"\u5931\u6557",text:"\u4F3A\u670D\u5668\u932F\u8AA4"})}})(),(s,l)=>(c(),u(B,null,[d("div",ae,[d("div",se,[d("h1",le,i(s.$t("cart")),1),r.length>0?(c(!0),u(B,{key:0},D(r,(t,V)=>(c(),_(f,{class:Q(["mt-4",{"bg-grey-lighten-1 ":!t.product.sell}]),key:t._id},{default:a(()=>[e(o,{cols:"12",md:""},{default:a(()=>[e(E,{src:t.product.image,onClick:m=>h(q).push(`/product/${t.product._id}`),style:{cursor:"pointer"}},null,8,["src","onClick"])]),_:2},1024),e(o,{cols:"12",md:"",class:"d-flex align-center justify-center text-center"},{default:a(()=>[d("h2",{class:"text-brown",onClick:m=>h(q).push(`/product/${t.product._id}`),style:{cursor:"pointer"}},i(t.product.name),9,ne)]),_:2},1024),e(o,{cols:"12",md:"",class:"d-flex align-center justify-center text-center"},{default:a(()=>[d("span",oe,"NT. "+i(t.product.price),1)]),_:2},1024),e(o,{cols:"12",md:"",class:"d-flex align-center justify-center text-center"},{default:a(()=>[e(v,{icon:"",variant:"text",onClick:m=>x(V,t.quantity-1),disabled:t.quantity<2},{default:a(()=>[e(w,{icon:"mdi-minus",color:"brown"})]),_:2},1032,["onClick","disabled"]),d("span",re,i(t.quantity),1),e(v,{icon:"",variant:"text",onClick:m=>x(V,t.quantity+1)},{default:a(()=>[e(w,{icon:"mdi-plus",color:"brown"})]),_:2},1032,["onClick"])]),_:2},1024),e(o,{cols:"12",md:"",class:"d-flex align-center justify-center text-center"},{default:a(()=>[d("span",ce,"NT. "+i(t.product.price*t.quantity),1)]),_:2},1024),e(o,{cols:"12",md:"",class:"d-flex align-center justify-center text-center"},{default:a(()=>[e(v,{icon:"",variant:"text",color:"red",onClick:m=>x(V,0)},{default:a(()=>[e(w,{icon:"mdi-trash-can-outline"})]),_:2},1032,["onClick"])]),_:2},1024),e(G,{class:"d-none d-md-block"})]),_:2},1032,["class"]))),128)):(c(),_(f,{key:1,class:"mt-15"},{default:a(()=>[$.value?(c(),_(o,{key:0,cols:"12",class:"text-center no_product_img"},{default:a(()=>[s.$i18n.locale==="tw"?(c(),u("img",de)):s.$i18n.locale==="en"?(c(),u("img",ie)):(c(),u("img",ue))]),_:1})):M("",!0)]),_:1})),e(f,null,{default:a(()=>[e(X),e(o,{cols:"12",md:"3",class:"text-center mt-10"},{default:a(()=>[d("span",pe,i(s.$t("totalprice"))+" : NT."+i(h(U)),1)]),_:1})]),_:1}),e(L,{modelValue:y.value,"onUpdate:modelValue":l[3]||(l[3]=t=>y.value=t),onSubmit:H(F,["prevent"])},{default:a(()=>[e(f,null,{default:a(()=>[e(o,{cols:"12",md:"6"},{default:a(()=>[e(C,{modelValue:n.receiver,"onUpdate:modelValue":l[0]||(l[0]=t=>n.receiver=t),type:"text",label:"\u6536\u4EF6\u8005\u59D3\u540D",placeholder:"\u8ACB\u8F38\u5165\u6536\u4EF6\u8005\u59D3\u540D",counter:"10",maxlength:"10",rules:[p.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(o,{cols:"12",md:"6"},{default:a(()=>[e(C,{modelValue:n.cellphone,"onUpdate:modelValue":l[1]||(l[1]=t=>n.cellphone=t),type:"text",label:"\u6536\u4EF6\u8005\u96FB\u8A71",placeholder:"\u8ACB\u8F38\u5165\u6536\u4EF6\u8005\u96FB\u8A71",rules:[p.required,p.isMobilePhone],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(o,{cols:"12"},{default:a(()=>[e(C,{modelValue:n.address,"onUpdate:modelValue":l[2]||(l[2]=t=>n.address=t),type:"text",label:"\u6536\u4EF6\u5730\u5740",placeholder:"\u8ACB\u8F38\u5165\u6536\u4EF6\u5730\u5740",rules:[p.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(o,{cols:"12",md:"2",class:"ma-auto"},{default:a(()=>[e(v,{color:"warning",block:"",variant:"outlined",type:"submit",disabled:!h(P)},{default:a(()=>[J(i(s.$t("confirmandsend")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])])]),g.value?(c(),_(K,{key:0})):M("",!0)],64))}};export{xe as default};
