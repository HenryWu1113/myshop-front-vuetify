import{o as A,A as T,as as z,aA as F,r as y,N as f,a as B,c as D,b as u,t as i,d as a,w as n,V as x,a3 as N,a9 as M,S as E,f as r,H as p,W as _,a5 as H,a6 as R,a7 as X,av as j,e as I,a8 as L,aw as O,aH as v,ax as W,T as Z,X as q}from"./index.790d3547.js";import"./index.d5f82810.js";import{v as G}from"./index.882724bf.js";import{V as J}from"./VFileInput.4450eb13.js";import"./isEmail.cbf882b7.js";var K="./assets/mango_cartoon.ee6a11ae.png",P="./assets/grass_cartoon.7cae4f84.png";const Q={id:"userinfo_view"},Y={class:"MyContainer"},ee={class:"text-h2 text-center text-brown font-weight-bold mt-10 mb-10","data-aos":"fade-down","data-aos-duration":"1000","data-aos-offset":"150"},ae={class:"user_info_card ps-5 pe-5"},le=u("img",{src:K,class:"mango d-none d-md-block animate__animated animate__shakeX"},null,-1),te=u("img",{src:P,class:"grass d-none d-lg-block"},null,-1),ne=["src"],oe={class:"user_info"},se={class:"user_info"},ie={class:"user_info"},ue={class:"text-center mt-3 mb-3"},ve={__name:"UserinfoView",setup(re){const V=q();A(()=>{T.init()});const g=z(),{editUser:C}=g,{nickname:h,email:k,account:b,avatar:$}=F(g),c=y(!1),m=y(!1),s=f({account:"",email:"",nickname:"",avatar:[]}),o=f({account:"",email:"",nickname:"",avatar:[]}),d=f({account:[e=>!!e||"\u5E33\u865F\u5FC5\u586B",e=>e.length>=4&&e.length<=20||"\u5E33\u865F\u9577\u5EA6\u70BA 4 \u5230 20 \u500B\u5B57",e=>/^[a-zA-Z0-9]+$/.test(e)||"\u5E33\u865F\u53EA\u80FD\u7531\u82F1\u6578\u5B57\u7D44\u6210"],nickname:[e=>!!e||"\u66B1\u7A31\u5FC5\u586B",e=>e&&e.length<=10||"\u66B1\u7A31\u9577\u5EA6\u4E0D\u5F97\u8D85\u904E 10 \u500B\u5B57"],email:[e=>!!e||"\u96FB\u5B50\u4FE1\u7BB1\u5FC5\u586B",e=>G.exports.isEmail(e)||"\u96FB\u5B50\u4FE1\u7BB1\u683C\u5F0F\u932F\u8AA4"],size:[e=>{var t,l,w;return!e||!e.length||((l=(t=e[0])==null?void 0:t.type)==null?void 0:l.includes("image"))&&((w=e[0])==null?void 0:w.size)<1024*1024||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26"}]}),U=()=>{c.value=!0,o.account=b.value,o.email=k.value,o.nickname=h.value,o.avatar=[]},S=async()=>{if(!m.value)return;const e=new FormData;for(const l in o)["account"].includes(l)||(l==="avatar"?e.append("image",o[l][0]):e.append(l,o[l]));const t=await C(e);console.log(e),t&&(s.account=b.value,s.email=k.value,s.nickname=h.value,s.avatar=$.value),c.value=!1};return(async()=>{try{V.show({color:"orange",loader:"bars",width:100,height:100});const{data:e}=await M.get("/users");o.account=e.result.account,o.email=e.result.email,o.nickname=e.result.nickname,s.account=e.result.account,s.email=e.result.email,s.nickname=e.result.nickname,s.avatar=e.result.avatar,V.hide()}catch(e){console.log(e),E.fire({icon:"error",title:"\u5931\u6557",text:"\u7121\u6CD5\u53D6\u5F97\u500B\u4EBA\u8CC7\u6599"})}})(),(e,t)=>(B(),D("div",Q,[u("div",Y,[u("h1",ee,i(e.$t("selfinfo")),1),u("div",ae,[le,te,a(x,null,{default:n(()=>[a(r,{cols:"12",md:"5",lg:"6"},{default:n(()=>[u("img",{src:s.avatar,class:"info_pic"},null,8,ne)]),_:1}),a(r,{cols:"12",md:"7",lg:"6",class:"d-flex flex-column justify-center"},{default:n(()=>[u("span",oe,i(e.$t("account"))+" : "+i(s.account),1),u("span",se,i(e.$t("nickname"))+" : "+i(s.nickname),1),u("span",ie,i(e.$t("mail"))+" : "+i(s.email),1)]),_:1}),a(r,{cols:"12",class:"text-center"},{default:n(()=>[a(p,{variant:"outlined",color:"deep-orange",onClick:U,class:"mb-5"},{default:n(()=>[_(i(e.$t("editselfinfo")),1)]),_:1})]),_:1})]),_:1}),a(N,{modelValue:c.value,"onUpdate:modelValue":t[6]||(t[6]=l=>c.value=l),persistent:""},{default:n(()=>[a(H,{onSubmit:R(S,["prevent"]),modelValue:m.value,"onUpdate:modelValue":t[5]||(t[5]=l=>m.value=l)},{default:n(()=>[a(X,null,{default:n(()=>[a(j,null,{default:n(()=>[u("h1",ue,i(e.$t("selfinfo")),1)]),_:1}),a(I),a(L,null,{default:n(()=>[a(O,null,{default:n(()=>[a(x,null,{default:n(()=>[a(r,{cols:"12"},{default:n(()=>[a(v,{type:"account",label:"\u5E33\u865F",placeholder:"\u8ACB\u8F38\u5165\u5E33\u865F",counter:"20",maxlength:"20",modelValue:o.account,"onUpdate:modelValue":t[0]||(t[0]=l=>o.account=l),rules:d.account,"append-inner-icon":"mdi-account-outline",variant:"outlined",disabled:""},null,8,["modelValue","rules"])]),_:1}),a(r,{cols:"12"},{default:n(()=>[a(v,{label:"\u66B1\u7A31",placeholder:"\u8ACB\u8F38\u5165\u66B1\u7A31",counter:"10",maxlength:"10",modelValue:o.nickname,"onUpdate:modelValue":t[1]||(t[1]=l=>o.nickname=l),rules:d.nickname,"append-inner-icon":"mdi-emoticon-happy-outline",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),a(r,{cols:"12"},{default:n(()=>[a(v,{type:"email",label:"\u96FB\u5B50\u4FE1\u7BB1",placeholder:"\u8ACB\u8F38\u5165\u96FB\u5B50\u4FE1\u7BB1",modelValue:o.email,"onUpdate:modelValue":t[2]||(t[2]=l=>o.email=l),rules:d.email,"append-inner-icon":"mdi-email-outline",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),a(r,{cols:"12"},{default:n(()=>[a(J,{modelValue:o.avatar,"onUpdate:modelValue":t[3]||(t[3]=l=>o.avatar=l),"show-size":"",accept:"image/*",label:"\u5927\u982D\u8CBC",rules:d.size,variant:"outlined","prepend-icon":"","append-inner-icon":"mdi-link-variant"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),a(W,null,{default:n(()=>[a(Z),a(p,{color:"brown",onClick:t[4]||(t[4]=l=>c.value=!1)},{default:n(()=>[_(i(e.$t("cancel")),1)]),_:1}),a(p,{type:"submit",color:"warning"},{default:n(()=>[_(i(e.$t("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit","modelValue"])]),_:1},8,["modelValue"])])])]))}};export{ve as default};
